(this["webpackJsonpdiatopia-app"]=this["webpackJsonpdiatopia-app"]||[]).push([[0],{51:function(e,t,i){},52:function(e,t,i){"use strict";i.r(t);var n,r,a=i(0),o=i.n(a),s=i(17),c=i(11),u=i(15),l=i(14);!function(e){e[e.aspect=1]="aspect",e[e.gridSize=32]="gridSize",e[e.fps=30]="fps"}(n||(n={})),function(e){e[e.UNIT_LENGTH=100]="UNIT_LENGTH",e[e.TICK_PER_SEC=20]="TICK_PER_SEC",e[e.TICK_PERIOD=50]="TICK_PERIOD",e[e.VIEWPORT_COLUMNS=7]="VIEWPORT_COLUMNS",e[e.VIEWPORT_ROWS=7]="VIEWPORT_ROWS",e[e.RENDER_COLUMNS=9]="RENDER_COLUMNS",e[e.RENDER_ROWS=9]="RENDER_ROWS"}(r||(r={}));var A=r,h=i(2),d=function(e){var t=e.width,i=e.height,n=e.children;return o.a.createElement(h.Stage,{width:t,height:i},n)},y=i(1),f=i(6),E=i(4),p=i(3),g=function(){function e(t,i){if(Object(y.a)(this,e),this.x=void 0,this.y=void 0,void 0===i){if("number"===typeof t)throw Error("Unexpected type of argument");this.x=t.x,this.y=t.y}else{if("number"!==typeof t||"number"!==typeof i)throw Error("Unexpected type of argument");this.x=t,this.y=i}}return Object(f.a)(e,null,[{key:"up",get:function(){return new e(0,-1)}},{key:"down",get:function(){return new e(0,1)}},{key:"left",get:function(){return new e(-1,0)}},{key:"right",get:function(){return new e(1,0)}},{key:"upRight",get:function(){return new e(1,-1)}},{key:"downRight",get:function(){return new e(1,1)}},{key:"downLeft",get:function(){return new e(-1,1)}},{key:"upLeft",get:function(){return new e(-1,-1)}}]),Object(f.a)(e,[{key:"isZero",value:function(){return 0===this.x&&0===this.y}},{key:"set",value:function(t,i){if(t instanceof e)return this.x=t.x,this.y=t.y,this;if("number"===typeof t&&"number"===typeof i)return this.x=t,this.y=i,this;throw Error("Unexpected argument type")}},{key:"add",value:function(t,i){if(t instanceof e)return this.x+=t.x,this.y+=t.y,this;if("number"===typeof t&&"number"===typeof i)return this.x+=t,this.y+=i,this;throw Error("Unexpected argument type")}},{key:"subtract",value:function(t,i){if(t instanceof e)return this.x-=t.x,this.y-=t.y,this;if("number"===typeof t&&"number"===typeof i)return this.x-=t,this.y-=i,this;throw Error("Unexpected argument type")}},{key:"multiply",value:function(t){if(t instanceof e)return this.x*=t.x,this.y*=t.y,this;if("number"===typeof t)return this.x*=t,this.y*=t,this;throw Error("Unexpected argument type")}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"cross",value:function(e){return this.x*e.y-this.y*e.x}},{key:"setLength",value:function(e){return this.normalize().multiply(e)}},{key:"divideScalar",value:function(e){return this.x/=e,this.y/=e,this}},{key:"normalize",value:function(){return this.divideScalar(this.length||1)}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"width",get:function(){return this.x}},{key:"height",get:function(){return this.y}},{key:"length",get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}}]),e}();g.isEqual=function(e,t){return e.x===t.x&&e.y===t.y};var v=g,T=function(){function e(t,i){var n;Object(y.a)(this,e),this.x=void 0,this.y=void 0,!(n=t)||isNaN(Number(n.x))||isNaN(Number(n.y))?(this.x=t,this.y=i):(this.x=t.x,this.y=t.y)}return Object(f.a)(e,null,[{key:"isEqual",value:function(e,t){return e.x===t.x&&e.y===t.y}}]),Object(f.a)(e,[{key:"round",value:function(t){return new e(Math.round(this.x/t)*t,Math.round(this.y/t)*t)}},{key:"floor",value:function(t){return new e(Math.floor(this.x/t)*t,Math.floor(this.y/t)*t)}},{key:"ceil",value:function(t){return new e(Math.ceil(this.x/t)*t,Math.ceil(this.y/t)*t)}},{key:"set",value:function(t,i){return t instanceof e?(this.x=t.x,this.y=t.y,this):(i=i,this.x=t,this.y=i,this)}},{key:"add",value:function(t,i){return t instanceof v||t instanceof e?(this.x+=t.x,this.y+=t.y,this):(i=i,this.x+=t,this.y+=i,this)}},{key:"subtract",value:function(t,i){return t instanceof v||t instanceof e?(this.x-=t.x,this.y-=t.y,this):(i=i,this.x-=t,this.y-=i,this)}},{key:"multiply",value:function(e){return e instanceof v?(this.x*=e.x,this.y*=e.y,this):(this.x*=e,this.y*=e,this)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"isEqual",value:function(e){return this.x===e.x&&this.y===e.y}},{key:"isWithin",value:function(e,t,i){return Array.isArray(e)?(t=t)?this.x>=e[0].x&&this.x<=e[1].x&&this.y>=e[0].y&&this.y<=e[1].y:this.x>e[0].x&&this.x<e[1].x&&this.y>e[0].y&&this.y<e[1].y:(t=t,i?this.x>=e.x&&this.x<=t.x&&this.y>=e.y&&this.y<=t.y:this.x>e.x&&this.x<t.x&&this.y>e.y&&this.y<t.y)}},{key:"length",get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}}]),e}(),w=function(){function e(t,i){if(Object(y.a)(this,e),this.start=void 0,this.end=void 0,i){if(!(t instanceof T&&i instanceof T))throw Error("Unexpected type of argument");this.start=t,this.end=i}else{if(!Array.isArray(t)||2!==t.length)throw Error("Unexpected type of argument");this.start=t[0],this.end=t[1]}}return Object(f.a)(e,[{key:"clone",value:function(){return new e(new T(this.start.x,this.start.y),new T(this.end.x,this.end.y))}},{key:"copy",value:function(e){return this.start.copy(e.start),this.end.copy(e.end),this}}]),e}(),O=i(20),b=i(21),m=i(23),S={ELEMENT:{CREATE:"ELEMENT_CREATE",DESTROY:"ELEMENT_DESTROY",UPDATE:"ELEMENT_UPDATE"},WORLD:{DAYLIGHT_CYCLE:"WORLD_DAYLIGHT_CYCLE",PLAYERS:{JOIN:"WORLD_PLAYERS_JOIN",MOVE:"WORLD_PLAYERS_MOVE"}},SURFACE:{DAYLIGHT_CYCLE:"SURFACE_DAYLIGHT_CYCLE",MOB:{MOVE:"SURFACE_MOB_MOVE"}},PLAYER:{MOVE:"PLAYER_MOVE"},MOB:{MOVE:"MOB_MOVE"}},R=function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(e){var n,r=e.id,a=e.layer,o=e.pos,s=e.aspect,c=e.isConcrete;return Object(y.a)(this,i),(n=t.call(this)).id=void 0,n.layer=void 0,n.pos=void 0,n.aspect=void 0,n.isConcrete=void 0,n.id=r,n.layer=a,n.pos=o instanceof T?o:new T(o),n.aspect=new v(s),n.isConcrete=c,n}return Object(f.a)(i,[{key:"width",get:function(){return this.aspect.width}},{key:"height",get:function(){return this.aspect.height}},{key:"borderPos",get:function(){return[this.pos.clone(),this.pos.clone().add(new v(this.width-1,this.height-1))]}},{key:"adjacentPos",get:function(){return[this.pos.clone().add(new v(this.width/2,0)).add(v.up.multiply(A.UNIT_LENGTH-1)),this.pos.clone().add(new v(this.width,this.height/2)).add(v.right.multiply(A.UNIT_LENGTH-1)),this.pos.clone().add(new v(this.width/2,this.height)).add(v.down.multiply(A.UNIT_LENGTH-1)),this.pos.clone().add(new v(0,this.height/2)).add(v.left.multiply(A.UNIT_LENGTH-1))]}}]),i}(function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(){var e;return Object(y.a)(this,i),(e=t.call(this)).lastTime=void 0,e.lastTime=0,e.timer=Object(m.setInterval)(e.update.bind(Object(O.a)(e)),1e3/n.fps),e}return Object(f.a)(i,[{key:"onDestroy",value:function(e){this.on(S.ELEMENT.DESTROY,e)}},{key:"destroy",value:function(){clearInterval(this.timer),this.emit(S.ELEMENT.DESTROY)}},{key:"onCreate",value:function(e){this.on(S.ELEMENT.CREATE,e)}},{key:"onUpdate",value:function(e){this.on(S.ELEMENT.UPDATE,e)}},{key:"create",value:function(){this.emit(S.ELEMENT.CREATE)}},{key:"update",value:function(){0===this.lastTime?this.create():this.emit(S.ELEMENT.UPDATE),this.lastTime+=1}},{key:"timer",set:function(e){}}]),i}(b.EventEmitter)),I=function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(e){var n,r=e.id,a=e.layer,o=e.pos,s=e.aspect,c=e.type,u=e.pattern,l=e.isConcrete,A=e.frames;return Object(y.a)(this,i),(n=t.call(this,{id:r,layer:a,pos:o,aspect:s,isConcrete:l})).type=void 0,n.pattern=void 0,n.frames=void 0,n.type=c,n.pattern=u,n.isConcrete=l,n.frames=A.map((function(e){return new w(new T(e.start),new T(e.end))})),n}return i}(R),P=function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(e){var n,r=e.id,a=e.layer,o=e.pos,s=e.aspect,c=e.isConcrete,u=e.type,l=e.pattern,A=e.frames,h=e.toward,d=e.isOpen;return Object(y.a)(this,i),(n=t.call(this,{id:r,layer:a,pos:o,aspect:s,isConcrete:c,type:u,pattern:l,frames:A})).toward=void 0,n.isOpen=void 0,n.toward=h,n.isOpen=d,n}return i}(I);P.TYPE={WOOD:0,STONE:1},P.PATTERNS={NORTH_SOUTH:0,EAST_WEST:1};var x=P,L=function(e){var t=e.type,i=e.pattern,n=e.isOpen,r=e.size,a=e.x,s=e.y,c=32*-t,u={x:0,y:0};switch(i){case x.PATTERNS.NORTH_SOUTH:u.x=0,u.y=c;break;case x.PATTERNS.EAST_WEST:u.x=-32,u.y=c}return o.a.createElement(h.TilingSprite,{key:"Door(".concat(a,",").concat(s,")"),image:n?"data:image/png;base64,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":"data:image/png;base64,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",tilePosition:u,width:r,height:r,x:a,y:s})},k=Object(a.memo)(L),C=function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(e){var n=e.id,r=e.layer,a=e.pos,o=e.aspect,s=e.isConcrete,c=e.type,u=e.pattern,l=e.frames;return Object(y.a)(this,i),t.call(this,{id:n,layer:r,pos:a,aspect:o,isConcrete:s,type:c,pattern:u,frames:l})}return i}(I);C.PATTERNS={INDIVIDUAL:0,SURFACE:1,INTERSECTION:2,NORTH_SOUTH:3,EAST_WEST:4,T:5,T_90_DEG:6,T_180_DEG:7,T_270_DEG:8,TOP_LEFT:9,TOP_RIGHT:10,BOTTOM_LEFT:11,BOTTOM_RIGHT:12};var N=C,M=i.p+"static/media/Wall.383d44ac.png",B=function(e){var t=e.type,i=e.pattern,n=e.size,r=e.x,a=e.y,s=96*-t,c={x:0,y:0};switch(i){case N.PATTERNS.TOP_LEFT:c.x=0,c.y=s-96;break;case N.PATTERNS.TOP_RIGHT:c.x=-64,c.y=s-96;break;case N.PATTERNS.BOTTOM_LEFT:c.x=0,c.y=s-160;break;case N.PATTERNS.BOTTOM_RIGHT:c.x=-64,c.y=s-160;break;case N.PATTERNS.NORTH_SOUTH:c.x=0,c.y=s-128;break;case N.PATTERNS.EAST_WEST:c.x=-32,c.y=s-96;break;case N.PATTERNS.INDIVIDUAL:c.x=-32,c.y=s-128;break;case N.PATTERNS.INTERSECTION:c.x=-128,c.y=s-128;break;case N.PATTERNS.T:c.x=-128,c.y=s-96;break;case N.PATTERNS.T_90_DEG:c.x=-160,c.y=s-128;break;case N.PATTERNS.T_180_DEG:c.x=-128,c.y=s-160;break;case N.PATTERNS.T_270_DEG:c.x=-96,c.y=s-128;break;case N.PATTERNS.SURFACE:c.x=-96,c.y=s-96}return o.a.createElement(h.TilingSprite,{key:"Wall(".concat(r,",").concat(a,")"),image:M,tilePosition:c,width:n,height:n,x:r,y:a})},D=Object(a.memo)(B),j=i.p+"static/media/Player0.1432bdef.png",H=function(e){var t=e.id,i=e.size,n=e.x,r=e.y;return o.a.createElement(h.TilingSprite,{key:t,image:j,tilePosition:{x:0,y:0},width:i,height:i,x:n,y:r})},F=Object(a.memo)(H),U=function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(e){var n,r=e.id,a=e.layer,o=e.pos,s=e.aspect,c=e.isConcrete,u=e.type,l=e.pattern;return Object(y.a)(this,i),(n=t.call(this,{id:r,layer:a,pos:o,aspect:s,isConcrete:c})).type=void 0,n.pattern=void 0,n.type=u,n.pattern=l,n}return i}(R);U.TYPES={PLAIN:0,TILE:1},U.PATTERNS={INDIVIDUAL:0,INTERSECTION:1,HORIZONTAL:{LEFT:2,MIDDLE:3,RIGHT:4},VERTICAL:{TOP:5,MIDDLE:6,BOTTOM:7},GRID:{TOP_LEFT:8,TOP_CENTER:9,TOP_RIGHT:10,MIDDLE_LEFT:11,MIDDLE_CENTER:12,MIDDLE_RIGHT:13,BOTTOM_LEFT:14,BOTTOM_CENTER:15,BOTTOM_RIGHT:16}};var Y=U,G=i.p+"static/media/Floor.9a12fe77.png",z=function(e){var t=e.type,i=e.pattern,n=e.size,r=e.x,a=e.y,s=96*-t,c={x:0,y:0};switch(i){case Y.PATTERNS.GRID.TOP_LEFT:c.x=0,c.y=s-96;break;case Y.PATTERNS.GRID.TOP_CENTER:c.x=-32,c.y=s-96;break;case Y.PATTERNS.GRID.TOP_RIGHT:c.x=-64,c.y=s-96;break;case Y.PATTERNS.GRID.MIDDLE_LEFT:c.x=0,c.y=s-128;break;case Y.PATTERNS.GRID.MIDDLE_CENTER:c.x=-32,c.y=s-128;break;case Y.PATTERNS.GRID.MIDDLE_RIGHT:c.x=-64,c.y=s-128;break;case Y.PATTERNS.GRID.BOTTOM_LEFT:c.x=0,c.y=s-160;break;case Y.PATTERNS.GRID.BOTTOM_CENTER:c.x=-32,c.y=s-160;break;case Y.PATTERNS.GRID.BOTTOM_RIGHT:c.x=-64,c.y=s-160;break;case Y.PATTERNS.VERTICAL.TOP:c.x=-96,c.y=s-96;break;case Y.PATTERNS.VERTICAL.MIDDLE:c.x=-96,c.y=s-128;break;case Y.PATTERNS.VERTICAL.BOTTOM:c.x=-96,c.y=s-160;break;case Y.PATTERNS.HORIZONTAL.LEFT:c.x=-128,c.y=s-128;break;case Y.PATTERNS.HORIZONTAL.MIDDLE:c.x=-160,c.y=s-128;break;case Y.PATTERNS.HORIZONTAL.RIGHT:c.x=-192,c.y=s-128;break;case Y.PATTERNS.INDIVIDUAL:c.x=-160,c.y=s-96;break;case Y.PATTERNS.INTERSECTION:c.x=-160,c.y=s-160}return o.a.createElement(h.TilingSprite,{key:"Floor(".concat(r,",").concat(a,")"),image:G,tilePosition:c,width:n,height:n,x:r,y:a})},Q=Object(a.memo)(z),V=function(e,t,i,n){return o.a.createElement(h.Graphics,{key:"(".concat(i,",").concat(n,")"),draw:function(e){e.clear(),e.beginFill(0,0),e.drawRect(i,n,t,t),e.endFill()}})},W=function(e){var t=e.size,i=e.x,n=e.y;return o.a.createElement(h.TilingSprite,{key:"Torch(".concat(i,",").concat(n,")"),image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAW5QTFRFAAAA/+VQ/+dM/bY2/bY4+7E0/uZG/7w//LY6/+hK/+lI/r88/r07/7w6/fe9+/W39/X29fX1+/a89vT19/f3tIxYtItXsIJRuodSs4hVn3lMnnhLeVU7elc7e1k+n3lKnHdKe1g8fVo+fVk/nnhJfFk9fls/gFxCr4xSrYpQakcxa0g0rYlPr4xUbEkzbEova0gysI5RsY5UhWBFgl1Cgl9Dr4tPs4xTg15Dg2BEso5UsI1TgFtAgF1BgV1DxKtobUo0bUo2wqlmxq5obEw1bEoxxq1qxa5rbEk1a0s0tpNdb0w4bks3cFA7s5NasZFYb1A7clM/uJpouJhnfGBLel9MfmNSjHRSj3JUfmNQgGNRgWZVjHNVj3RZgW5nhGlYjXRWgGtWf2RTg2ZWhGhavaFyvKBxgWVZg2hXhWhau59wgmhZgmZYhWlbkXhaj3VahGpbkHdZjXNYg2dZhmpekHZdj3Vcg2lcg2dbhGpdK/5JYgAAAHp0Uk5TAP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9bcsYGAAAAzklEQVR4nK3KV1uBAQAGUHsTJTszCdmy+cisFGWPshXZRfn3/sF70eNcHxLpuMgUKo2OAoPCpLJQYHO4PD4KghOhSATDqfBMjMK5RCqTo6BQqi7UKGi0Or0BBe2l8cqEwrXZYrGicGOzO5wouNwe7y0KPr83EEQhFI5EYygQhCOeQOEumUrbUchkc/dxFNwPj/knFJ4LxRcYXkvlShWFWr3RbKHQfntvdVDo9vqDIQqj8cfnBIbp12yOwmI5nK9QWG9m3z8obHe/f3sU/uMAFkUg4Ln5jOkAAAAASUVORK5CYII=",tilePosition:{x:0,y:0},width:t,height:t,x:i,y:n})},J=Object(a.memo)(W),X="data:image/png;base64,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",K=function(e){var t=e.id,i=e.size,n=e.x,r=e.y;return o.a.createElement(h.TilingSprite,{key:t,image:X,tilePosition:{x:-32,y:-32},width:i,height:i,x:n,y:r})},q=Object(a.memo)(K),Z=function(e){var t=e.id,i=e.size,n=e.x,r=e.y;return o.a.createElement(h.TilingSprite,{key:t,image:X,tilePosition:{x:-32,y:-64},width:i,height:i,x:n,y:r})},_=Object(a.memo)(Z),$=function(e){var t=e.id,i=e.size,n=e.x,r=e.y;return o.a.createElement(h.TilingSprite,{key:t,image:X,tilePosition:{x:-32,y:0},width:i,height:i,x:n,y:r})},ee=Object(a.memo)($),te=function(e){var t=e.id,i=e.size,n=e.x,r=e.y;return o.a.createElement(h.TilingSprite,{key:t,image:X,tilePosition:{x:-32,y:-96},width:i,height:i,x:n,y:r})},ie=Object(a.memo)(te),ne={Floor:Q,Wall:D,Door:k,Torch:J,Player:F,Cow:q,Goat:_,Sheep:ie,Pig:ee,Object:V},re=function(){function e(t,i,n){Object(y.a)(this,e),this.target=void 0,this.position=void 0,this.layer=void 0,this.target=t,this.position=i,this.layer=n}return Object(f.a)(e,[{key:"toSprite",get:function(){return ne[this.target.constructor.name](this.target,n.gridSize,this.position.x,this.position.y)}}]),e}();var ae=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.gridSize*A.RENDER_ROWS,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.aspect,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.gridSize,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:A.UNIT_LENGTH,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new T(0,0);Object(y.a)(this,e),this.layers=void 0,this.fov=void 0,this.aspect=void 0,this.near=void 0,this.far=void 0,this.position=void 0,this.layers={},this.fov=t,this.aspect=i,this.near=r,this.far=a,this.position=o}return Object(f.a)(e,[{key:"transform",value:function(e){return e instanceof T?e.clone().subtract(this.farPlaneBound[0]).multiply(this.mag).round(1):e instanceof w?new w(e.start.clone().subtract(this.farPlaneBound[0]).multiply(this.mag),e.end.clone().subtract(this.farPlaneBound[0]).multiply(this.mag)):void 0}},{key:"capture",value:function(e){var t=this,i=this.farPlaneBound,n={},r=0;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=e[a];n[a]={visibilty:!0,images:o.filter((function(e){return e.pos.isWithin(i,!0)})).map((function(e){return new re(e,t.transform(e.pos),e.layer)})).sort((function(e,t){return e.layer-t.layer})),order:r++}}return this.layers=n,n}},{key:"mag",get:function(){return this.near/this.far}},{key:"offset",get:function(){var e=this.position.clone().multiply(this.mag),t=e.x,i=e.y,r=new T(this.position.x%A.UNIT_LENGTH===A.UNIT_LENGTH/2-1?Math.floor(t):Math.round(t),this.position.y%A.UNIT_LENGTH===A.UNIT_LENGTH/2-1?Math.floor(i):Math.round(i));return new T(-(A.RENDER_COLUMNS-A.VIEWPORT_COLUMNS)/2*n.gridSize-(r.x%n.gridSize<n.gridSize/2?r.x%n.gridSize:r.x%n.gridSize-n.gridSize),-(A.RENDER_ROWS-A.VIEWPORT_ROWS)/2*n.gridSize-(r.y%n.gridSize<n.gridSize/2?r.y%n.gridSize:r.y%n.gridSize-n.gridSize))}},{key:"farPlaneBound",get:function(){var e,t=new T(0,0),i=new T(0,0),r=(this.fov/n.gridSize-1)/2*n.gridSize/this.mag,a=(this.fov*this.aspect/n.gridSize-1)/2*n.gridSize/this.mag,o=(e=this.position,new T({x:Math.round(e.x/A.UNIT_LENGTH)*A.UNIT_LENGTH,y:Math.round(e.y/A.UNIT_LENGTH)*A.UNIT_LENGTH}));return t.set(o.clone().subtract(new v(a,r))),i.set(o.clone().add(new v(A.UNIT_LENGTH,A.UNIT_LENGTH)).add(new v(a,r))),[t,i]}},{key:"nearPlaneBound",get:function(){var e=this;return this.farPlaneBound.map((function(t){return t.multiply(e.mag)}))}}]),e}(),oe=i(5),se=i(12),ce=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new T(0,0),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new v(1,0);Object(y.a)(this,e),this.origin=void 0,this.direction=void 0,this.origin=t,this.direction=i}return Object(f.a)(e,[{key:"set",value:function(e,t){return this.origin.copy(e),this.direction.copy(t),this}},{key:"at",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new v(0,0);return t.copy(this.direction).multiply(e).add(this.origin.x,this.origin.y)}},{key:"clone",value:function(){return new e(new T(this.origin.x,this.origin.y),new v(this.direction.x,this.direction.y))}},{key:"copy",value:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}}]),e}(),ue=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new T(0,0),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new v(1,0),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Object(y.a)(this,e),this.ray=void 0,this.near=void 0,this.far=void 0,this.ray=new ce(t,i),this.far=n,this.near=r}return Object(f.a)(e,[{key:"set",value:function(e,t){this.ray.set(e,t)}},{key:"intersect",value:function(e){var t=this.ray.origin.x,i=this.ray.origin.y,n=this.ray.direction.x,r=this.ray.direction.y,a=e.start.x,o=e.start.y,s=e.end.x-e.start.x,c=e.end.y-e.start.y;if(n*c===r*s)return null;var u=(n*(o-i)+r*(t-a))/(s*r-c*n),l=(s*(i-o)+c*(a-t))/(n*c-r*s);if(l<0)return null;if(u<0||u>1)return null;var A=new v(t+n*l-this.ray.origin.x,i+r*l-this.ray.origin.y).length;return A>this.near&&A<this.far?{distance:A,point:new T(t+n*l,i+r*l),param:l,angle:Math.atan(l)}:null}}]),e}(),le=function(){function e(t,i,r,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e-5;Object(y.a)(this,e),this.observer=void 0,this.obstructors=void 0,this.bound=void 0,this.offset=void 0,this.observer=t.transform(i).clone().add(new v(n.gridSize/2,n.gridSize/2)),this.obstructors=a.images.filter((function(e){return e.target.frames})).map((function(e){return e.target.frames})).flat().map((function(e){return t.transform(e)})).concat([new w(new T(0,0),new T(r.x,0)),new w(new T(r.x,0),new T(r.x,r.y)),new w(new T(r.x,r.y),new T(0,r.y)),new w(new T(0,r.y),new T(0,0))]),this.bound=r,this.offset=o}return Object(f.a)(e,[{key:"area",get:function(){var e=this,t=this.obstructors.map((function(e){return[new T(e.start.x,e.start.y),new T(e.end.x,e.end.y)]})).flat().reduce((function(e,t){return e.set.has("".concat(t.x,",").concat(t.y))||(e.set.add("".concat(t.x,",").concat(t.y)),e.filtered.push(t)),e}),{filtered:[],set:new Set}).filtered.map((function(t){var i=Math.atan2(t.y-e.observer.y,t.x-e.observer.x);return[i-e.offset,i,i+e.offset]})).flat().reduce((function(t,i){var n=Math.cos(i),r=Math.sin(i),a=new ue(e.observer,new v(n,r)),o=e.obstructors.reduce((function(e,t){var i=a.intersect(t);return i&&(!e||i.param<e.param)?i:e}),null);return o?(t.push(Object(se.a)(Object(se.a)({},o),{},{angle:i})),t):t}),[]);return t.sort((function(e,t){return e.angle-t.angle})),t}}]),e}(),Ae=function(e){var t=e.camera,i=e.observer,r=e.bound,s=e.blurSize,c=e.structuresLayer,u=new le(t,i,r,void 0===c?{visibility:!0,images:[],order:1}:c).area.map((function(e){return[Math.round(e.point.x),Math.round(e.point.y)]})).flat(),l=Object(a.useCallback)((function(e){e.clear(),e.beginFill(0),e.drawRect(0,0,n.gridSize*A.RENDER_ROWS,n.gridSize*A.RENDER_COLUMNS),e.beginHole(),e.drawPolygon(u),e.endHole(),e.endFill()}),[u]);return o.a.createElement(h.Container,null,o.a.createElement(h.Graphics,{draw:l,filters:s?[new oe.v.BlurFilter(s)]:void 0}))},he=function(){function e(t,i,n,r,a){Object(y.a)(this,e),this.bound=void 0,this.obstructors=void 0,this.segments=void 0,this.lightImages=void 0,this.obstructors=r.images.filter((function(e){return e.target.frames})).map((function(e){return e.target.frames})).flat().map((function(e){return t.transform(e)})),this.bound=i,this.segments=a,this.lightImages=n.images}return Object(f.a)(e,[{key:"areas",get:function(){var e=this;return this.lightImages.map((function(t){for(var i=[],r=0;r<e.segments;r++)i.push(-Math.PI+2*r*Math.PI/e.segments);var a=i.reduce((function(i,r){var a=Math.cos(r),o=Math.sin(r),s=new ue(t.position.clone().add(new v(n.gridSize/2,n.gridSize/2)),new v(a,o),64),c=e.obstructors.reduce((function(e,t){var i=s.intersect(t);return i&&(!e||i.param<e.param)?i:e}),null);return c?(i.push(Object(se.a)(Object(se.a)({},c),{},{angle:r})),i):(i.push({distance:64,point:new T(0,0).add(s.ray.at(64)),param:Math.tan(r),angle:r}),i)}),[]);return a.sort((function(e,t){return e.angle-t.angle})),{lightLevel:t.target.lightLevel,vertices:a}}))}}]),e}(),de=function(e){var t=e.renderer,i=e.camera,r=e.skylightLevel,s=e.bound,c=e.lightsLayer,u=void 0===c?{visibility:!0,images:[],order:2}:c,l=e.structuresLayer,d=void 0===l?{visibility:!0,images:[],order:1}:l,y=e.offset,f=e.blurSize,E=void 0===f?0:f,p=e.children,g=new he(i,s,u,d,36).areas,v=Object(a.useMemo)((function(){return new oe.g}),[]);v.clear(),v.beginFill(16711680,.05*r),v.drawRect(0,0,n.gridSize*A.RENDER_ROWS,n.gridSize*A.RENDER_COLUMNS),g.forEach((function(e){var t=e.vertices.map((function(e){return[Math.round(e.point.x),Math.round(e.point.y)]})).flat();v.beginFill(16711680,.05*e.lightLevel),v.drawPolygon(t),v.endFill()})),v.endFill(),E&&(v.filters=[new oe.v.BlurFilter(E)]);var T=new oe.p(t.generateTexture(v,oe.m.NEAREST,1,new oe.l(E?.1*-y.x:-y.x,E?.1*-y.y:-y.y,n.gridSize*A.RENDER_COLUMNS,n.gridSize*A.RENDER_ROWS)));return o.a.createElement(h.Container,{mask:T,position:[y.x,y.y]},p)},ye=Object(a.memo)(de),fe=l.c,Ee=i(31),pe=function(){function e(t){var i=t.lastTime,n=t.dayTime;Object(y.a)(this,e),this.lastTime=void 0,this.dayTime=void 0,this.lastTime=i,this.dayTime=n,setInterval(this.update.bind(this),e.TICK_PERIOD)}return Object(f.a)(e,[{key:"update",value:function(){this.dayTime===e.DAY_PERIOD-1?this.dayTime=0:this.dayTime+=1,this.lastTime+=1}}]),e}();pe.TICK_PERIOD=50,pe.DAY_PERIOD=24e3;var ge=pe,ve=function(){function e(t){var i=t.time,n=t.lightLevel,r=t.spawnPos,a=t.blocks,o=t.entities,s=t.border;Object(y.a)(this,e),this.spawnPos=void 0,this.blocks=void 0,this.entities=void 0,this.lightLevel=void 0,this.time=void 0,this.border=void 0,this.time=i instanceof ge?i:new ge(i),this.lightLevel=n,this.spawnPos=r instanceof T?r:new T(r),this.blocks=a,this.entities=o,this.border=s instanceof v?s:new v(s)}return Object(f.a)(e,[{key:"getBlock",value:function(e,t){return this.blocks.find((function(i){return i.id===e&&T.isEqual(i.pos,t)}))}},{key:"updateBlock",value:function(e){var t=this.blocks.findIndex((function(t){return t.id===e.id&&T.isEqual(e.pos,t.pos)}));this.blocks.splice(t,1,e)}},{key:"updateEntity",value:function(e){var t=this.entities.findIndex((function(t){return t.uid===e.uid}));this.entities.splice(t,1,e)}},{key:"clear",value:function(e){var t=this.entities.find((function(t){return t.uid===e.uid}));t?(t.destroy(),this.entities=this.entities.filter((function(e){return e.uid!==t.uid}))):console.error()}}]),e}();ve.UNIT_SIZE=32;var Te,we=ve,Oe=function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(e){var n=e.time,r=e.lightLevel,a=e.spawnPos,o=e.blocks,s=e.entities,c=e.border;return Object(y.a)(this,i),t.call(this,{time:n,lightLevel:r,spawnPos:a,blocks:o,entities:s,border:c})}return i}(we),be=i(32),me=i(9),Se=function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(e){var n,r=e.id,a=e.layer,o=e.pos,s=e.aspect,c=e.isConcrete,u=e.uid,l=e.facing,A=e.rotation,h=e.speed,d=e.motion;return Object(y.a)(this,i),(n=t.call(this,{id:r,layer:a,pos:o,aspect:s,isConcrete:c})).uid=void 0,n.facing=void 0,n.rotation=void 0,n.speed=void 0,n.motion=void 0,n.uid=u,n.id=r,n.facing=l,n.rotation=A,n.speed=h,n.motion=new v(d),n}return i}(R),Re=function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(e){var n,r=e.id,a=e.layer,o=e.pos,s=e.aspect,c=e.isConcrete,u=e.uid,l=e.rotation,A=e.speed,h=e.spawnPos,d=e.facing,f=e.motion,E=e.isMotion,p=e.health,g=e.inventory;return Object(y.a)(this,i),(n=t.call(this,{id:r,layer:a,pos:o,aspect:s,isConcrete:c,uid:u,rotation:l,speed:A,facing:d,motion:f})).spawnPos=void 0,n.abilities=void 0,n.isMotion=void 0,n.health=void 0,n.inventory=void 0,n.spawnPos=new T(h),n.abilities={speed:16,acceleration:4},n.isMotion=E,n.health=p,n.inventory=g,n}return Object(f.a)(i,[{key:"update",value:function(){Object(be.a)(Object(me.a)(i.prototype),"update",this).call(this),this.isMotion?this.accelerate():this.motion.isZero()||this.brake(),this.motion.isZero()||this.move(this.motion.clone().multiply(A.TICK_PER_SEC/n.fps).round())}},{key:"brake",value:function(){var e=new v(Math.cos(this.rotation),-Math.sin(this.rotation));v.isEqual(this.motion.clone().subtract(e.clone().multiply(this.abilities.acceleration*A.TICK_PER_SEC/n.fps)).normalize().round(),e.clone().round())?this.motion.subtract(e.multiply(this.abilities.acceleration*A.TICK_PER_SEC/n.fps)):this.motion=new v(0,0)}},{key:"accelerate",value:function(){var e=new v(Math.cos(this.rotation),-Math.sin(this.rotation));this.motion.clone().add(e.clone().multiply(this.abilities.acceleration*A.TICK_PER_SEC/n.fps)).length>this.abilities.speed*A.TICK_PER_SEC/n.fps?this.motion=e.multiply(this.abilities.speed*A.TICK_PER_SEC/n.fps):this.motion.add(e.clone().multiply(this.abilities.acceleration*A.TICK_PER_SEC/n.fps))}},{key:"move",value:function(e){this.pos.add(e)}},{key:"moveTo",value:function(e){this.pos.set(e)}},{key:"facingPos",get:function(){return[this.pos.add(v.up.multiply(we.UNIT_SIZE)),this.pos.add(v.right.multiply(we.UNIT_SIZE)),this.pos.add(v.down.multiply(we.UNIT_SIZE)),this.pos.add(v.left.multiply(we.UNIT_SIZE))][this.facing]}}]),i}(Se),Ie={level:new Oe({time:{lastTime:0,dayTime:0},lightLevel:0,spawnPos:{x:0,y:0},blocks:[],entities:[],border:{x:0,y:0}}),players:[new Re({id:"diatopia:player",layer:2,pos:{x:0,y:0},aspect:{x:0,y:0},isConcrete:!0,uid:"",rotation:0,speed:0,spawnPos:{x:0,y:0},facing:0,motion:{x:0,y:0},isMotion:!1,health:10,inventory:[]})],player:new Re({id:"diatopia:player",layer:2,pos:{x:0,y:0},aspect:{x:0,y:0},isConcrete:!0,uid:"",rotation:0,speed:0,spawnPos:{x:0,y:0},facing:0,motion:{x:0,y:0},isMotion:!1,health:10,inventory:[]})},Pe={"diatopia:floor":Y,"diatopia:wall":N,"diatopia:door":x,"diatopia:torch":function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(e){var n=e.id,r=e.layer,a=e.pos,o=e.aspect,s=e.isConcrete,c=e.lightLevel;return Object(y.a)(this,i),t.call(this,{id:n,layer:r,pos:a,aspect:o,isConcrete:s,lightLevel:c})}return i}(function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(e){var n,r=e.id,a=e.layer,o=e.pos,s=e.aspect,c=e.isConcrete,u=e.lightLevel;return Object(y.a)(this,i),(n=t.call(this,{id:r,layer:a,pos:o,aspect:s,isConcrete:c})).lightLevel=void 0,n.lightLevel=u,n}return i}(R)),"diatopia:player":Re},xe=function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(e){var n,r=e.id,a=e.layer,o=e.pos,s=e.aspect,c=e.isConcrete,u=e.uid,l=e.facing,A=e.rotation,h=e.speed,d=e.mass,f=e.health,E=e.attributes,p=e.motion;return Object(y.a)(this,i),(n=t.call(this,{id:r,layer:a,pos:o,aspect:s,isConcrete:c,uid:u,rotation:A,speed:h,facing:l,motion:p})).mass=void 0,n.health=void 0,n.attributes=void 0,n.mass=d,n.health=f,n.attributes=E,n}return i}(Se),Le=function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(e){var n=e.id,r=e.layer,a=e.pos,o=e.aspect,s=e.isConcrete,c=e.uid,u=e.facing,l=e.rotation,A=e.speed,h=e.mass,d=e.health,f=e.attributes,E=e.motion;return Object(y.a)(this,i),t.call(this,{id:n,layer:r,pos:a,aspect:o,isConcrete:s,uid:c,facing:u,rotation:l,speed:A,mass:h,health:d,attributes:f,motion:E})}return i}(xe),ke=function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(e){var n=e.id,r=e.layer,a=e.pos,o=e.aspect,s=e.isConcrete,c=e.uid,u=e.facing,l=e.rotation,A=e.speed,h=e.mass,d=e.health,f=e.attributes,E=e.motion;return Object(y.a)(this,i),t.call(this,{id:n,layer:r,pos:a,aspect:o,isConcrete:s,uid:c,facing:u,rotation:l,speed:A,mass:h,health:d,attributes:f,motion:E})}return i}(xe),Ce=function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(e){var n=e.id,r=e.layer,a=e.pos,o=e.aspect,s=e.isConcrete,c=e.uid,u=e.facing,l=e.rotation,A=e.speed,h=e.mass,d=e.health,f=e.attributes,E=e.motion;return Object(y.a)(this,i),t.call(this,{id:n,layer:r,pos:a,aspect:o,isConcrete:s,uid:c,facing:u,rotation:l,speed:A,mass:h,health:d,attributes:f,motion:E})}return i}(xe),Ne=function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(e){var n=e.id,r=e.layer,a=e.pos,o=e.aspect,s=e.isConcrete,c=e.uid,u=e.facing,l=e.rotation,A=e.speed,h=e.mass,d=e.health,f=e.attributes,E=e.motion;return Object(y.a)(this,i),t.call(this,{id:n,layer:r,pos:a,aspect:o,isConcrete:s,uid:c,facing:u,rotation:l,speed:A,mass:h,health:d,attributes:f,motion:E})}return i}(xe),Me=function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(e){var n,r=e.id,a=e.layer,o=e.pos,s=e.aspect,c=e.isConcrete,u=e.uid,l=e.facing,A=e.rotation,h=e.speed,d=e.motion,f=e.age,E=e.health;return Object(y.a)(this,i),(n=t.call(this,{id:r,layer:a,pos:o,aspect:s,isConcrete:c,uid:u,facing:l,rotation:A,speed:h,motion:d})).age=void 0,n.health=void 0,n.age=f,n.health=E,n}return i}(Se),Be=function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(e){var n=e.count,r=e.slot;return Object(y.a)(this,i),t.call(this,{id:"diatopia:door",count:n,slot:r})}return i}((function e(t){var i=t.id,n=t.count,r=t.slot;Object(y.a)(this,e),this.count=void 0,this.slot=void 0,this.id=void 0,this.id=i,this.count=n,this.slot=r})),De={"diatopia:goat":ke,"diatopia:cow":Le,"diatopia:sheep":Ce,"diatopia:pig":Ne,"diatopia:item":function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(e){var n,r=e.id,a=e.layer,o=e.pos,s=e.aspect,c=e.isConcrete,u=e.uid,l=e.facing,A=e.rotation,h=e.speed,d=e.motion,f=e.age,E=e.health;return Object(y.a)(this,i),(n=t.call(this,{id:r,layer:a,pos:o,aspect:s,isConcrete:c,uid:u,facing:l,rotation:A,speed:h,motion:d,age:f,health:E})).item=void 0,n.item=new Be({count:1}),n}return i}(Me)},je={"diatopia:door":Be},He=Object(u.b)({name:"players",initialState:Ie,reducers:{initLevel:function(e,t){var i=t.payload,n=i.time,r=i.lightLevel,a=i.spawnPos,o=i.blocks,s=i.entities,c=i.border;e.level=new Oe({time:n,lightLevel:r,spawnPos:a,blocks:o.map((function(e){return new Pe[e.id](e)})),entities:s.map((function(e){return new De[e.id](e)})),border:c})},updateLightlevel:function(e,t){e.level.lightLevel=t.payload},updateStructure:function(e,t){e.level.updateBlock(new Pe[t.payload.id](t.payload))},updateEntity:function(e,t){e.level.updateEntity(new De[t.payload.id](t.payload))},clearEntity:function(e,t){e.level.clear(t.payload)},initPlayer:function(e,t){var i=e.players.find((function(e){return e.uid===t.payload}));i?e.player=i:console.error("Player ".concat(t.payload.uid," could NOT be found."))},movePlayer:function(e,t){e.player.moveTo(new T(t.payload.pos)),e.player.motion=new v(t.payload.motion),e.player.rotation=t.payload.rotation},initPlayers:function(e,t){e.players=t.payload.map((function(e){return new Re(e)}))},removePlayer:function(e,t){var i=e.players.findIndex((function(e){return e.uid===t.payload}));e.players.splice(i,1)},addPlayer:function(e,t){-1===e.players.findIndex((function(e){return e.uid===t.payload.uid}))&&e.players.push(new Re(t.payload))},movePlayerById:function(e,t){var i=e.players.find((function(e){return e.uid===t.payload.uid}));i?(i.moveTo(new T(t.payload.pos)),i.motion=new v(t.payload.motion),i.rotation=t.payload.rotation,i.isMotion=t.payload.isMotion):console.error("Player ".concat(t.payload.uid," could NOT be found."))},playersObtain:function(e,t){var i=e.players.find((function(e){return e.uid===t.payload.uid}));if(i){var n=i.inventory.find((function(e){return e.id===t.payload.item.id}));i.inventory=n?i.inventory.map((function(e){return e.slot===t.payload.item.slot?new je[t.payload.item.id](t.payload.item):e})):[].concat(Object(Ee.a)(i.inventory),[new je[t.payload.item.id](t.payload.item)])}else console.error("Player ".concat(t.payload.uid," could NOT be found."))}}}),Fe=He.actions,Ue=Fe.initLevel,Ye=Fe.updateEntity,Ge=Fe.updateLightlevel,ze=Fe.updateStructure,Qe=Fe.clearEntity,Ve=Fe.initPlayer,We=Fe.movePlayer,Je=Fe.initPlayers,Xe=Fe.removePlayer,Ke=Fe.addPlayer,qe=Fe.movePlayerById,Ze=Fe.playersObtain,_e=function(e){return e.world.level},$e=function(e){return e.world.player},et=function(e){return e.world.player.inventory},tt=function(e){return e.world.players},it=He.reducer,nt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,t=Object(a.useState)(0),i=Object(c.a)(t,2),n=i[0],r=i[1];return Object(h.useTick)((function(t){r((function(i){return i+e*(t||0)}))})),n},rt=function(e){var t=e.layer,i=null===t||void 0===t?void 0:t.images.map((function(e){return o.a.createElement(F,{key:e.target.uid,id:e.target.uid,size:n.gridSize,x:e.position.x,y:e.position.y})}));return o.a.createElement(o.a.Fragment,null,i)},at=function(e){var t=e.layer,i=null===t||void 0===t?void 0:t.images.map((function(e){switch(e.target.id){case"diatopia:floor":return o.a.createElement(Q,{key:"".concat(e.target.id,"(").concat(e.position.x,",").concat(e.position.y,")"),type:e.target.type,pattern:e.target.pattern,size:n.gridSize,x:e.position.x,y:e.position.y});case"diatopia:door":return o.a.createElement(k,{key:"".concat(e.target.id,"(").concat(e.position.x,",").concat(e.position.y,")"),type:e.target.type,pattern:e.target.pattern,isOpen:e.target.isOpen,size:n.gridSize,x:e.position.x,y:e.position.y});case"diatopia:wall":return o.a.createElement(D,{key:"".concat(e.target.id,"(").concat(e.position.x,",").concat(e.position.y,")"),type:e.target.type,pattern:e.target.pattern,size:n.gridSize,x:e.position.x,y:e.position.y});case"diatopia:torch":return o.a.createElement(J,{key:"".concat(e.target.id,"(").concat(e.position.x,",").concat(e.position.y,")"),size:n.gridSize,x:e.position.x,y:e.position.y});default:return null}}));return o.a.createElement(o.a.Fragment,null,i)},ot={"diatopia:door":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAACFQTFRFFAwcRSQ0MDRt030shk0w06qaTUlNbcPLhpaidXFh3+/XGNBGpQAAAHdJREFUeJxjYGAQVFISZAACQWNnE2NFBgZGk5BUtxBnAQZmNxAj2YBB3c0kGYiSGDSml5cvX1XhxKAxowMIOp0YNJmcVJQUGpwYFEBqzNmdGFRAuiI4nCC6DBuBiqdXVS2vQtWlpKKkpODEIAAx2ZGBKclNBYgSACyKIxxqX5EYAAAAAElFTkSuQmCC"},st=function(e){var t=e.id,i=e.x,n=e.y,r=2*Math.sin(nt()),a=Math.cos(nt(.05));return o.a.createElement(h.Sprite,{image:ot[t],x:8+i,y:8+n+r,scale:[a,1],anchor:.5})},ct=Object(a.memo)(st),ut=function(e){var t=e.layer,i=null===t||void 0===t?void 0:t.images.map((function(e){switch(e.target.id){case"diatopia:cow":return o.a.createElement(q,{key:e.target.uid,id:e.target.uid,size:n.gridSize,x:e.position.x,y:e.position.y});case"diatopia:goat":return o.a.createElement(_,{key:e.target.uid,id:e.target.uid,size:n.gridSize,x:e.position.x,y:e.position.y});case"diatopia:pig":return o.a.createElement(ee,{key:e.target.uid,id:e.target.uid,size:n.gridSize,x:e.position.x,y:e.position.y});case"diatopia:sheep":return o.a.createElement(ie,{key:e.target.uid,id:e.target.uid,size:n.gridSize,x:e.position.x,y:e.position.y});case"diatopia:item":return o.a.createElement(ct,{key:e.target.uid,id:e.target.item.id,x:e.position.x,y:e.position.y});default:return null}}));return o.a.createElement(o.a.Fragment,null,i)},lt=function(){var e=Object(a.useRef)(new ae(A.RENDER_ROWS*n.gridSize)),t=Object(h.useApp)().renderer,i=fe(_e),r=fe(tt),s=fe($e);nt(),e.current.position=s.pos;var c=e.current.capture({blocks:Object.values(i.blocks),entities:Object.values(i.entities),players:r});return o.a.createElement(ye,{renderer:t,camera:e.current,skylightLevel:i.lightLevel,bound:new v(n.gridSize*A.RENDER_COLUMNS,n.gridSize*A.RENDER_ROWS),lightsLayer:c.blocks,structuresLayer:c.blocks,blurSize:4,offset:e.current.offset},o.a.createElement(at,{layer:c.blocks}),o.a.createElement(ut,{layer:c.entities}),o.a.createElement(rt,{layer:c.players}),o.a.createElement(Ae,{camera:e.current,bound:new v(n.gridSize*A.RENDER_COLUMNS,n.gridSize*A.RENDER_ROWS),observer:s.pos,blurSize:4,structuresLayer:c.blocks}))},At=i.p+"static/media/GUI0.5be9bc10.png",ht=function(e){var t=e.index,i={x:e.isFull?0:-16,y:-16};return o.a.createElement(h.TilingSprite,{key:t,image:At,tilePosition:i,width:16,height:16,x:16*t})},dt=function(e){var t=e.point,i=Array.from({length:Math.floor(t/2)},(function(e,t){return o.a.createElement(ht,{index:t,isFull:!0,key:t})}));return t%2===1&&i.push(o.a.createElement(ht,{index:i.length,isFull:!1,key:i.length})),o.a.createElement(h.Container,null,i)},yt=function(e){var t=e.count,i=(e.slot,e.id),n=e.position;return o.a.createElement(h.Container,{position:n},o.a.createElement(h.Sprite,{image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAFFQTFRFzs7Oq6urk5OTbW1tXV1dZ2dnYmJiWlpacHBwR0dHZmZmHh0PJSMSKigSKCcSIyIRIiERfn5+YGBgAAAAgICAIR8Qd3d3JiUSPz0yiYmJhISEkC39FAAAABt0Uk5T/////////////////////////3//////////WQ1hYgAAAJ5JREFUeJy904sKwyAMBVC1vqppV51dH///oYu1MDawCpZdJKAcDAohhBBKKcMc5SddR4qAUo4RAouUinOl4hLi2Oi+R2DsJwDDAOMIMY9pcjWAMW/tM5N0A28EjIlmcNEiJDDPhRuKACAHXumj8sDVgYsWdwGzLI1AlMAfXnEDWNdGoN13tn3HqvUWwvlROJbeH7MpeRpM3BgTjyvAGz7ZOVUi/x16AAAAAElFTkSuQmCC"}),i&&o.a.createElement(h.Sprite,{image:ot[i],anchor:.5,position:[16,16]}),t&&o.a.createElement(h.Text,{anchor:.5,position:[24,20],text:t.toString(),style:new oe.r({fontSize:14,fill:"#fff"})}))},ft=function(e){var t=e.gridNumber,i=fe(et),r=Array.from({length:t},(function(e,r){return o.a.createElement(yt,Object.assign({key:r},i.find((function(e){return e.slot===r})),{position:[r*n.gridSize-Math.floor(t/2)*n.gridSize,0]}))}));return o.a.createElement(h.Container,{position:[7*n.gridSize/2,6*n.gridSize]},r)},Et=function(){var e=fe($e);return o.a.createElement(h.Container,null,o.a.createElement(dt,{point:e.health}),o.a.createElement(ft,{gridNumber:4}))};!function(e){e.UP_KEY="w",e.DOWN_KEY="s",e.LEFT_KEY="a",e.RIGHT_KEY="d"}(Te||(Te={}));var pt=Te,gt={WORLD:{UPDATE:"WORLD_UPDATE"},LEVEL:{INIT:"LEVEL_INIT",UPDATE:{LIGHTLEVEL:"LEVEL_UPDATE_LIGHTLEVEL",STRUCTURE:"LEVEL_UPDATE_STRUCTURE"},CLEAR:{ENTITY:"LEVEL_CLEAR_ENTITY"}},ENTITY:{MOB:{MOVE:"ENTITY_MOB_MOVE"}},PLAYER:{INIT:"PLAYER_INIT",JOIN:"PLAYER_JOIN",MOVE:"PLAYER_MOVE",INTERACT:"PLAYER_INTERACT"},PLAYERS:{INIT:"PLAYERS_INIT",JOIN:"PLAYERS_JOIN",LEAVE:"PLAYERS_LEAVE",MOVE:"PLAYERS_MOVE",OBTAIN:"PLAYERS_OBTAIN"}};Object.freeze(gt);var vt=gt,Tt={update:function(){return{type:vt.WORLD.UPDATE}},move:function(e,t){return{type:vt.PLAYER.MOVE,payload:{dir:e,motion:t}}},interact:function(){return{type:vt.PLAYER.INTERACT,payload:null}}};Object.freeze(Tt);var wt,Ot=Tt;!function(e){e[e.EAST=0]="EAST",e[e.NORTH_EAST=1]="NORTH_EAST",e[e.NORTH=2]="NORTH",e[e.NORTH_WEST=3]="NORTH_WEST",e[e.WEST=4]="WEST",e[e.SOUTH_WEST=5]="SOUTH_WEST",e[e.SOUTH=6]="SOUTH",e[e.SOUTH_EAST=7]="SOUTH_EAST"}(wt||(wt={}));var bt=function(){function e(){Object(y.a)(this,e),this.keysPressed=void 0,this.keysPressed={}}return Object(f.a)(e,[{key:"setUp",value:function(e){document.body.addEventListener("keydown",this.keydownHandler.bind(this,e)),document.body.addEventListener("keyup",this.keyupHandler.bind(this,e))}},{key:"keydownHandler",value:function(e,t){this.keysPressed[t.key]||(this.keysPressed[t.key]=!0,this.moveControl(e,t.key))}},{key:"keyupHandler",value:function(e,t){delete this.keysPressed[t.key],this.interactControl(e,t.key),this.moveControl(e,t.key)}},{key:"interactControl",value:function(e,t){"e"!==t&&"E"!==t||e.send(Ot.interact())}},{key:"moveControl",value:function(e,t){var i=0!==Object.keys(this.keysPressed).length;if((this.keysPressed.ArrowUp||this.keysPressed[pt.UP_KEY])&&(this.keysPressed.ArrowRight||this.keysPressed[pt.RIGHT_KEY]))e.send(Ot.move(wt.NORTH_EAST,i));else if((this.keysPressed.ArrowDown||this.keysPressed[pt.DOWN_KEY])&&(this.keysPressed.ArrowRight||this.keysPressed[pt.RIGHT_KEY]))e.send(Ot.move(wt.SOUTH_EAST,i));else if((this.keysPressed.ArrowDown||this.keysPressed[pt.DOWN_KEY])&&(this.keysPressed.ArrowLeft||this.keysPressed[pt.LEFT_KEY]))e.send(Ot.move(wt.SOUTH_WEST,i));else if((this.keysPressed.ArrowUp||this.keysPressed[pt.UP_KEY])&&(this.keysPressed.ArrowLeft||this.keysPressed[pt.LEFT_KEY]))e.send(Ot.move(wt.NORTH_WEST,i));else if(this.keysPressed.ArrowUp||this.keysPressed[pt.UP_KEY])e.send(Ot.move(wt.NORTH,i));else if(this.keysPressed.ArrowRight||this.keysPressed[pt.RIGHT_KEY])e.send(Ot.move(wt.EAST,i));else if(this.keysPressed.ArrowDown||this.keysPressed[pt.DOWN_KEY])e.send(Ot.move(wt.SOUTH,i));else if(this.keysPressed.ArrowLeft||this.keysPressed[pt.LEFT_KEY])e.send(Ot.move(wt.WEST,i));else switch(t){case"ArrowUp":case pt.UP_KEY:e.send(Ot.move(wt.NORTH,i));break;case"ArrowDown":case pt.DOWN_KEY:e.send(Ot.move(wt.SOUTH,i));break;case"ArrowLeft":case pt.LEFT_KEY:e.send(Ot.move(wt.WEST,i));break;case"ArrowRight":case pt.RIGHT_KEY:e.send(Ot.move(wt.EAST,i))}}}]),e}();var mt,St=function(e){var t=e.username,i=e.clientRef,n=Object(l.b)();return Object(a.useEffect)((function(){window.WebSocket?i.current.connect({username:t},"ws://localhost:443/websocket",(function(){(new bt).setUp(i.current),i.current.onAction((function(){i.current.release().then((function(e){e.forEach((function(e){return function(e,t){switch(t.type){case vt.LEVEL.INIT:e(Ue(t.payload));break;case vt.LEVEL.UPDATE.LIGHTLEVEL:e(Ge(t.payload));break;case vt.LEVEL.UPDATE.STRUCTURE:e(ze(t.payload));break;case vt.LEVEL.CLEAR.ENTITY:e(Qe(t.payload));break;case vt.ENTITY.MOB.MOVE:e(Ye(t.payload));break;case vt.PLAYER.INIT:e(Ve(t.payload));break;case vt.PLAYER.MOVE:e(We(t.payload));break;case vt.PLAYERS.INIT:e(Je(t.payload));break;case vt.PLAYERS.LEAVE:e(Xe(t.payload));break;case vt.PLAYERS.JOIN:e(Ke(t.payload));break;case vt.PLAYERS.MOVE:e(qe(t.payload));break;case vt.PLAYERS.OBTAIN:e(Ze(t.payload))}}(n,e)}))}))}))})):alert("WebSocket not supported by your browser!")}),[i,t,n]),o.a.createElement(o.a.Fragment,null,o.a.createElement(lt,null),o.a.createElement(Et,null))};!function(e){e[e.TITLE=0]="TITLE",e[e.MAIN=1]="MAIN"}(mt||(mt={}));var Rt=mt,It=function(e){var t=e.setStage;return o.a.createElement(h.Container,null,o.a.createElement(h.Text,{text:"Diatopia",anchor:.5,x:A.VIEWPORT_COLUMNS*n.gridSize/2,y:A.VIEWPORT_ROWS*n.gridSize/4,style:new oe.r({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:50,fill:"#ffffff",strokeThickness:5})}),o.a.createElement(h.Text,{buttonMode:!0,interactive:!0,click:function(e){t(Rt.MAIN)},text:"Play",anchor:.5,x:A.VIEWPORT_COLUMNS*n.gridSize/2,y:A.VIEWPORT_ROWS*n.gridSize/2,style:new oe.r({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:18,fill:"#ffffff",strokeThickness:5})}))},Pt=function(e){Object(E.a)(i,e);var t=Object(p.a)(i);function i(){var e;return Object(y.a)(this,i),(e=t.call(this)).user=void 0,e.ws=void 0,e.buffer=void 0,e.callback=void 0,e.buffer=[],e}return Object(f.a)(i,[{key:"onAction",value:function(e){this.on("action",e)}},{key:"connect",value:function(e,t,i,n){this.ws=new WebSocket(t,n),this.user=e,this.callback=i,this.setUp()}},{key:"release",value:function(){var e=this;return new Promise((function(t){t(e.buffer.splice(0,e.buffer.length))}))}},{key:"send",value:function(e){if(!this.ws)throw Error("Server is not connected.");this.ws.send(JSON.stringify(e))}},{key:"setUp",value:function(){if(!this.ws)throw Error("Server is not connected.");this.ws.onclose=function(e){console.log("Connection is closed",e)},this.ws.onerror=function(e){console.error("WebSocket got error",e)},this.ws.onmessage=function(e){var t=JSON.parse(e.data);this.buffer=this.buffer.concat(t),this.emit("action",this.buffer)}.bind(this),this.ws.onopen=function(e){var t;console.log("WebSocket is connecting",e),this.callback&&this.callback(),null===(t=this.ws)||void 0===t||t.send(JSON.stringify({type:vt.PLAYER.JOIN,payload:this.user}))}.bind(this)}},{key:"readyState",get:function(){return this.ws?this.ws.readyState:WebSocket.CLOSED}}]),i}(b.EventEmitter),xt=Object(u.a)({reducer:{world:it},middleware:Object(u.c)({serializableCheck:!1})}),Lt=function(e){var t=e.username,i=Object(a.useRef)(new Pt),r=Object(a.useState)(Rt.TITLE),s=Object(c.a)(r,2),u=s[0],h=s[1];return o.a.createElement(d,{width:n.gridSize*A.VIEWPORT_COLUMNS,height:n.gridSize*A.VIEWPORT_ROWS},o.a.createElement(l.a,{store:xt},u===Rt.TITLE&&o.a.createElement(It,{setStage:h}),u===Rt.MAIN&&o.a.createElement(St,{username:t,clientRef:i})))},kt=function(){var e=Object(a.useRef)(null),t=Object(a.useState)(""),i=Object(c.a)(t,2),n=i[0],r=i[1];return o.a.createElement(o.a.Fragment,null,n?o.a.createElement(Lt,{username:n}):o.a.createElement("div",null,"username: ",o.a.createElement("input",{ref:e,type:"text"})," ",o.a.createElement("button",{onClick:function(){e.current.value&&r(e.current.value)}},"Play")))},Ct=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,53)).then((function(t){var i=t.getCLS,n=t.getFID,r=t.getFCP,a=t.getLCP,o=t.getTTFB;i(e),n(e),r(e),a(e),o(e)}))},Nt=(i(51),document.getElementById("dr"));Object(s.render)(o.a.createElement(kt,null),Nt),Ct()}},[[52,1,2]]]);
//# sourceMappingURL=main.04ac8c5a.chunk.js.map